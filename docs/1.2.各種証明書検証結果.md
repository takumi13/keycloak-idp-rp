# keycloak側
## Keycloak サーバ証明書の中身表示

```sh
keycloak-idp-rp$ openssl x509 -in certs/keycloak-server.crt -text -noout
Certificate:
    Data:
        Version: 1 (0x0)
        Serial Number: 1 (0x1)
        Signature Algorithm: sha256WithRSAEncryption
        Issuer: CN = test-ca
        Validity
            Not Before: Nov 14 01:10:05 2025 GMT
            Not After : Nov 14 01:10:05 2026 GMT
        Subject: CN = localhost
        Subject Public Key Info:
            Public Key Algorithm: rsaEncryption
                RSA Public-Key: (2048 bit)
                Modulus:
                    00:c1:ff:56:b5:f0:17:6d:40:38:5f:9b:06:5a:b5:
                    7b:4d:e3:3a:1c:6e:28:8b:1f:ac:af:66:7d:b6:04:
                    56:3b:60:45:71:a5:22:cb:4f:2e:50:a2:e9:03:dc:
                    77:1a:31:d8:52:f4:d6:b0:b6:02:5f:7c:41:f5:dc:
                    15:7f:94:36:7f:03:62:45:f8:32:aa:c4:b0:f9:aa:
                    cd:ae:f6:4d:38:d0:e7:a3:ff:1e:69:5a:f0:d0:99:
                    41:d9:1d:43:70:52:c8:e1:d1:51:b6:5a:03:46:e5:
                    d5:08:63:f3:97:ee:66:81:ac:30:86:b7:12:ea:1c:
                    8a:59:4c:9c:37:ce:f2:7f:7b:af:f6:e3:2d:9b:b5:
                    2a:93:a4:27:cc:71:8d:10:ef:63:90:b4:93:00:fd:
                    f3:50:db:4c:83:5a:3c:3d:b3:43:82:e9:f0:2f:30:
                    59:72:60:79:a1:ca:e5:fa:84:f1:4e:c2:ad:d4:6f:
                    93:48:ba:02:48:d2:00:c0:b3:ce:35:49:68:f1:28:
                    62:39:ed:29:60:4d:14:86:3b:f5:c2:14:73:a9:b5:
                    c7:26:99:f2:6f:4c:51:47:f6:ef:98:0a:ee:a2:fa:
                    19:d7:27:3a:1b:f1:5f:60:6b:ab:8d:6d:d7:0c:52:
                    26:70:e4:29:12:8b:c6:5b:3f:e9:a4:c6:aa:06:03:
                    b7:35
                Exponent: 65537 (0x10001)
    Signature Algorithm: sha256WithRSAEncryption
         8b:1b:e4:34:32:1b:c7:63:36:fd:e1:77:bb:32:f7:4e:e3:8d:
         27:62:0f:41:77:28:9a:cb:37:98:c5:cf:45:78:19:ad:d2:8e:
         2d:e3:b9:09:e4:75:c7:7d:6c:f1:13:3e:92:f5:06:54:ff:f4:
         01:b2:e4:ab:9c:d9:91:6e:cb:4f:20:63:f2:c5:d5:2f:7f:9e:
         e4:3e:63:ba:38:4f:e9:ec:0d:bd:fc:14:1e:5d:f0:39:48:c7:
         c3:51:b7:c8:82:3c:0e:f0:55:e3:b0:5b:1f:c5:54:31:ca:dc:
         07:e3:1c:96:54:e3:b7:ae:1a:e8:28:90:fd:28:7c:5a:c6:66:
         63:6b:fb:8e:0a:3f:5b:7b:ee:b6:71:b3:9e:a0:ef:94:92:02:
         8e:60:f4:4d:42:8d:3d:f7:f6:4a:45:94:34:da:09:91:43:c4:
         9e:2d:46:b3:49:f9:7d:fc:ee:d7:2b:43:d6:1f:fc:ca:05:f2:
         e6:6e:53:7d:d4:2d:9f:62:d0:c6:38:20:38:f0:e9:70:bd:76:
         0d:c9:b8:97:23:03:eb:4f:8a:65:77:41:24:08:77:f9:e6:65:
         f0:5d:06:81:bd:ba:57:e5:8f:5a:3c:fe:99:f6:09:b5:8e:38:
         45:e1:9c:54:46:2d:03:c9:2d:8e:73:ee:9d:fa:8d:fb:63:49:
         26:19:90:89
```

## Keycloak truststore の中身表示

``` sh
keycloak-idp-rp$ keytool -list -v \
> -keystore certs/keycloak-truststore.p12 \
> -storetype PKCS12 \
> -storepass changeit
Keystore type: PKCS12
Keystore provider: SUN

Your keystore contains 1 entry

Alias name: local-keycloak
Creation date: Nov 15, 2025
Entry type: trustedCertEntry

Owner: CN=localhost
Issuer: CN=test-ca
Serial number: 1
Valid from: Fri Nov 14 10:10:05 JST 2025 until: Sat Nov 14 10:10:05 JST 2026
Certificate fingerprints:
         SHA1: 46:A6:2E:60:B5:29:70:E7:92:59:B2:25:B9:76:F8:E1:60:5A:DD:DD
         SHA256: 53:16:EF:23:4B:18:DC:6F:45:AA:EF:F9:E6:2D:8F:A7:17:74:94:34:79:24:DF:BD:F4:00:F8:3F:04:13:19:06
Signature algorithm name: SHA256withRSA
Subject Public Key Algorithm: 2048-bit RSA key
Version: 1


*******************************************
*******************************************
```

## oidc-clientを検証するためのtruststore

``` sh
keycloak-idp-rp$ keytool -list -v \
> -keystore ssl/truststore.p12 \
> -storetype PKCS12 \
> -storepass changeit
Keystore type: PKCS12
Keystore provider: SUN

Your keystore contains 1 entry

Alias name: oidc-client-user
Creation date: Nov 15, 2025
Entry type: trustedCertEntry

Owner: CN=semi, OU=Dev, O=YourOrg, L=Tokyo, ST=Tokyo, C=JP
Issuer: CN=semi, OU=Dev, O=YourOrg, L=Tokyo, ST=Tokyo, C=JP
Serial number: a9d1d6c57f0f1917
Valid from: Fri Nov 14 11:19:01 JST 2025 until: Mon Nov 12 11:19:01 JST 2035
Certificate fingerprints:
         SHA1: 1E:B4:93:79:8B:30:2F:D7:26:E3:53:1D:17:74:36:14:AE:66:0A:4F
         SHA256: 95:F2:F0:DA:40:A3:AB:94:61:C9:A5:C3:08:47:A8:21:70:3E:A2:5B:94:F4:C0:93:98:15:9B:52:CB:E7:16:C4
Signature algorithm name: SHA384withRSA
Subject Public Key Algorithm: 2048-bit RSA key
Version: 3

Extensions:

#1: ObjectId: 2.5.29.14 Criticality=false
SubjectKeyIdentifier [
KeyIdentifier [
0000: 27 2B E9 A7 45 CF 35 AA   65 1B FB A8 AF EE 11 B6  '+..E.5.e.......
0010: 93 8E EF 64                                        ...d
]
]



*******************************************
*******************************************
```

# クライアントアプリ側
## OIDCクライアントサーバ keystore の中身（app-keystore）

``` sh
keycloak-idp-rp$ keytool -list -v \
> -keystore spring-boot-oidc-client/src/main/resources/ssl/app-keystore.p12 \
> -storetype PKCS12 \
> -storepass changeit
Keystore type: PKCS12
Keystore provider: SUN

Your keystore contains 1 entry

Alias name: oidc-client
Creation date: Nov 14, 2025
Entry type: PrivateKeyEntry
Certificate chain length: 1
Certificate[1]:
Owner: CN=localhost, OU=Dev, O=YourOrg, L=Tokyo, ST=Tokyo, C=JP
Issuer: CN=localhost, OU=Dev, O=YourOrg, L=Tokyo, ST=Tokyo, C=JP
Serial number: b09d4a6242bcf484
Valid from: Fri Nov 14 11:14:41 JST 2025 until: Mon Nov 12 11:14:41 JST 2035
Certificate fingerprints:
         SHA1: C8:DC:B5:44:4A:1F:19:E4:9E:03:68:C8:5E:34:21:64:8D:18:26:07
         SHA256: 80:DA:20:27:4B:67:0F:40:D4:09:B4:91:A0:0D:57:C4:4C:FE:11:88:BE:4A:93:12:CF:E4:31:AD:05:27:E4:AD
Signature algorithm name: SHA384withRSA
Subject Public Key Algorithm: 2048-bit RSA key
Version: 3

Extensions:

#1: ObjectId: 2.5.29.17 Criticality=false
SubjectAlternativeName [
  DNSName: localhost
  IPAddress: 127.0.0.1
  IPAddress: 0:0:0:0:0:0:0:1
]

#2: ObjectId: 2.5.29.14 Criticality=false
SubjectKeyIdentifier [
KeyIdentifier [
0000: A0 95 6A 59 89 97 3B 5C   31 62 11 22 36 40 3E 92  ..jY..;\1b."6@>.
0010: 8C D6 6B 07                                        ..k.
]
]



*******************************************
*******************************************
```

## クライアント keystore（client-keystore）の Subject / SAN を確認

``` sh
keycloak-idp-rp$ keytool -list -v \
> -keystore spring-boot-oidc-client/src/main/resources/ssl/client-keystore.p12 \
> -storetype PKCS12 \
> -storepass changeit
Keystore type: PKCS12
Keystore provider: SUN

Your keystore contains 1 entry

Alias name: oidc-client-user
Creation date: Nov 14, 2025
Entry type: PrivateKeyEntry
Certificate chain length: 1
Certificate[1]:
Owner: CN=semi, OU=Dev, O=YourOrg, L=Tokyo, ST=Tokyo, C=JP
Issuer: CN=semi, OU=Dev, O=YourOrg, L=Tokyo, ST=Tokyo, C=JP
Serial number: a9d1d6c57f0f1917
Valid from: Fri Nov 14 11:19:01 JST 2025 until: Mon Nov 12 11:19:01 JST 2035
Certificate fingerprints:
         SHA1: 1E:B4:93:79:8B:30:2F:D7:26:E3:53:1D:17:74:36:14:AE:66:0A:4F
         SHA256: 95:F2:F0:DA:40:A3:AB:94:61:C9:A5:C3:08:47:A8:21:70:3E:A2:5B:94:F4:C0:93:98:15:9B:52:CB:E7:16:C4
Signature algorithm name: SHA384withRSA
Subject Public Key Algorithm: 2048-bit RSA key
Version: 3

Extensions:

#1: ObjectId: 2.5.29.14 Criticality=false
SubjectKeyIdentifier [
KeyIdentifier [
0000: 27 2B E9 A7 45 CF 35 AA   65 1B FB A8 AF EE 11 B6  '+..E.5.e.......
0010: 93 8E EF 64                                        ...d
]
]



*******************************************
*******************************************
```

## truststore系（app-truststore / truststore）の中にどの証明書が入っているか
### ssl/app-truststore.p12

``` sh
keycloak-idp-rp$ keytool -list -v \
> -keystore spring-boot-oidc-client/src/main/resources/ssl/app-truststore.p12 \
> -storetype PKCS12 \
> -storepass changeit
Keystore type: PKCS12
Keystore provider: SUN

Your keystore contains 1 entry

Alias name: oidc-client-user
Creation date: Nov 15, 2025
Entry type: trustedCertEntry

Owner: CN=semi, OU=Dev, O=YourOrg, L=Tokyo, ST=Tokyo, C=JP
Issuer: CN=semi, OU=Dev, O=YourOrg, L=Tokyo, ST=Tokyo, C=JP
Serial number: a9d1d6c57f0f1917
Valid from: Fri Nov 14 11:19:01 JST 2025 until: Mon Nov 12 11:19:01 JST 2035
Certificate fingerprints:
         SHA1: 1E:B4:93:79:8B:30:2F:D7:26:E3:53:1D:17:74:36:14:AE:66:0A:4F
         SHA256: 95:F2:F0:DA:40:A3:AB:94:61:C9:A5:C3:08:47:A8:21:70:3E:A2:5B:94:F4:C0:93:98:15:9B:52:CB:E7:16:C4
Signature algorithm name: SHA384withRSA
Subject Public Key Algorithm: 2048-bit RSA key
Version: 3

Extensions:

#1: ObjectId: 2.5.29.14 Criticality=false
SubjectKeyIdentifier [
KeyIdentifier [
0000: 27 2B E9 A7 45 CF 35 AA   65 1B FB A8 AF EE 11 B6  '+..E.5.e.......
0010: 93 8E EF 64                                        ...d
]
]



*******************************************
*******************************************
```

### ssl/truststore.p12

``` sh
keycloak-idp-rp$ keytool -list -v \
> -keystore spring-boot-oidc-client/src/main/resources/ssl/truststore.p12 \
> -storetype PKCS12 \
> -storepass changeit
Keystore type: PKCS12
Keystore provider: SUN

Your keystore contains 1 entry

Alias name: oidc-client-user
Creation date: Nov 15, 2025
Entry type: trustedCertEntry

Owner: CN=semi, OU=Dev, O=YourOrg, L=Tokyo, ST=Tokyo, C=JP
Issuer: CN=semi, OU=Dev, O=YourOrg, L=Tokyo, ST=Tokyo, C=JP
Serial number: a9d1d6c57f0f1917
Valid from: Fri Nov 14 11:19:01 JST 2025 until: Mon Nov 12 11:19:01 JST 2035
Certificate fingerprints:
         SHA1: 1E:B4:93:79:8B:30:2F:D7:26:E3:53:1D:17:74:36:14:AE:66:0A:4F
         SHA256: 95:F2:F0:DA:40:A3:AB:94:61:C9:A5:C3:08:47:A8:21:70:3E:A2:5B:94:F4:C0:93:98:15:9B:52:CB:E7:16:C4
Signature algorithm name: SHA384withRSA
Subject Public Key Algorithm: 2048-bit RSA key
Version: 3

Extensions:

#1: ObjectId: 2.5.29.14 Criticality=false
SubjectKeyIdentifier [
KeyIdentifier [
0000: 27 2B E9 A7 45 CF 35 AA   65 1B FB A8 AF EE 11 B6  '+..E.5.e.......
0010: 93 8E EF 64                                        ...d
]
]



*******************************************
*******************************************
```